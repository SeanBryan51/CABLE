<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="description" content="Documentation for CABLE">
    <meta name="author" content="CABLE community" >
    <link rel="icon" href="../favicon.png">

    <title>ruff_resist &ndash; CABLE</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

         <script src="../js/jquery-2.1.3.min.js"></script>
         <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">CABLE </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
                 data-toggle="dropdown" role="button"
                 aria-haspopup="true"
                 aria-expanded="false">
                 Contents <span class="caret"></span>
              </a>
              <ul class="dropdown-menu">
                    <li><a href="../lists/files.html">Source Files</a></li>
                  <li><a href="../lists/modules.html">Modules</a></li>
                  <li><a href="../lists/procedures.html">Procedures</a></li>
                  <li><a href="../lists/types.html">Derived Types</a></li>
                  <li><a href="../lists/programs.html">Programs</a></li>
              </ul>
            </li>
                <li class="visible-xs hidden-sm visible-lg">
                  <a href="../lists/files.html">Source Files</a>
                </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/modules.html">Modules</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/procedures.html">Procedures</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/types.html">Derived Types</a>
              </li>
              <li class="visible-xs hidden-sm visible-lg">
                <a href="../lists/programs.html">Programs</a>
              </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
  <div class="row">
    <h1>ruff_resist
      <small>Subroutine</small>
      
    </h1>
      <div class="row" id="info-bar">
    <div class="col-lg-12">
      <div class="well well-sm">
        <ul class="list-inline" style="margin-bottom:0px;display:inline">

          <li id="statements"><i class="fa fa-list-ol"></i>
            <a data-toggle="tooltip"
               data-placement="bottom" data-html="true"
               title=" 0.2% of total for procedures.">92 statements</a>
          </li>

            <li id="source-file">
              <i class="fa fa-code"></i>
              <a href="../src/cable_roughness.F90"> Source File</a>
            </li>
        </ul>
        <ol class="breadcrumb in-well text-right">
              <li><a href='../sourcefile/cable_roughness.f90.html'>cable_roughness.F90</a></li>
              <li><a href='../module/cable_roughness_module.html'>cable_roughness_module</a></li>
          <li class="active">ruff_resist</li>
        </ol>
      </div>
    </div>
  </div>
  <script>
    $(function () {
    $('[data-toggle="tooltip"]').tooltip()
    })
  </script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
      <div id="sidebar">
      <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  


  </div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>public  subroutine ruff_resist(veg, rough, ssnow, canopy, LAI_pft, HGT_pft, reducedLAIdue2snow)  
</h2>
        <div class="panel panel-default">
      <div class="panel-heading">
        <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
          <li class="list-group-item">
            <ul class="list-inline">
                <li><a href='../module/cable_def_types_mod.html'>cable_def_types_mod</a></li>
                <li><a href='../module/cable_other_constants_mod.html'>cable_other_constants_mod</a></li>
                <li><a href='../module/cbl_hruff_mod.html'>cbl_hruff_mod</a></li>
                <li><a href='../module/cbl_lai_eff_mod.html'>cbl_LAI_eff_mod</a></li>
                <li><a href='../module/cable_common_module.html'>cable_common_module</a></li>
            </ul>
          </li>
      </ul>
    </div>


    <p>Calculates the roughness parameters and the aerodynamic contribution to the
 resistances controlling the fluxes between the land and atmosphere for each 
 land point.</p>
<h2>Scientific description</h2>
<p>The scientific basis for the formulae is a combination of Localised Near 
 Field theory for aerodynamic transfer within canopies (for the heat and 
 water vapour fluxes) and bulk formulae for the roughness length and 
 displacement height accounting for roughness sublayer effects (for the 
 momentum flux).</p>
<p>The calculations take into account whether:</p>
<ol>
<li>the soil model used is SLI or the default (soilsnow)</li>
<li>the land point is vegetated (LAI &gt; LAI_THRESH) or not</li>
</ol>
<p>The primary references for these formulations are</p>
<ul>
<li><a href="https://doi.org/10.1002/qj.49711548710">Raupach MR (1989)</a></li>
<li><a href="https://doi.org/10.1007/BF00155203">Raupach MR (1992)</a></li>
<li><a href="https://doi.org/10.1007/BF00709229">Raupach MR (1994)</a></li>
<li><a href="http://www.cmar.csiro.au/e-print/open/kowalczykea_2006a.pdf">Kowalczyk et al. (2006)</a></li>
</ul>
<h2>Outputs</h2>
<p>The principal outputs from the MODULE are</p>
<ul>
<li><code>rough%zref_tq</code>: reference height above the displacement height for the 
   air temperature and humidity, where these forcing observations are deemed
   to have been collected (m) </li>
<li><code>rough%zref_uv</code>: height above the displacement height for the 
   wind speeds, where the forcing observations are deemed to have been 
   collected (m) </li>
<li><code>rough%hruff</code>: the canopy height accounting for the presence of snow (m)</li>
<li><code>canopy%vlaiw</code>: the leaf area index accounting for the presence of snow 
   (m<script type="math/tex">^2</script> m<script type="math/tex">^{-2}</script>)</li>
<li><code>rough%z0soil</code>: the aerodynamic roughness length for soil (m)</li>
<li><code>rough%z0ssoilsn</code>: the aerodynamic roughness length for snow (m)</li>
<li><code>rough%z0m</code>: the aerodynamic roughness length for the surface 
   (canopy+soil+snow) (m)</li>
<li><code>rough%disp</code>: the displacement height of the surface 
   (=0.0 if not vegetated) (m)</li>
<li><code>rough%zruffs</code>: the depth of the roughness sublayer over vegetated
   surfaces (m)</li>
<li>
<p><code>rough%coexp</code>: the extinction coefficient for the wind speed profile 
   within the canopy, <script type="math/tex">c_{0}</script> (m<script type="math/tex">^{-1}</script>). </p>
<p>
<script type="math/tex">c_{0}</script> is defined to be the coefficient within an expontial wind 
profile, i.e. the wind speed at height <script type="math/tex">z</script> above the ground within 
a canopy of height <script type="math/tex">h_c</script> is given by 
<script type="math/tex"> U(z) = U_{h} \exp\{ c_{0} (z-h_c) \} </script> where <script type="math/tex">U_h</script> is the wind 
speed at canopy top.</p>
</li>
<li>
<p><code>rough%usuh</code>: the ratio of the friction velocity, <script type="math/tex">u_*</script>, to the wind 
   speed at canopy top (-)</p>
</li>
<li><code>rough%rt0us</code>: <em>normalised</em> aerodynamic resistance for the turbulent
   transfer from the soil/snow surface to the displacement height (-)</li>
<li>
<p><code>rough%rt1us</code>: <em>normalised</em> aerodynamic resistance for the turbulent 
   transfer from the displacement height to the reference level (-)</p>
<p><code>rough%rt1us</code> is evaluated in three subparts (<code>rough%rt1usa</code>, 
<code>rough%rt1usb</code>, and <code>rough%rt1usc</code>). One of the resistance terms 
(<code>rough%rt1usc</code>) is evaluated in subroutine <a href="../proc/define_canopy.html">define_canopy</a>.</p>
</li>
</ul>
<p>Each of the normalized resistances are given by the theoretical formulae 
 given by the references. The aerodynamic resistances for the current 
 time step are evaluated later by dividing the <em>normalized resistances</em> by 
 the current time step's friction velocity <code>canopy%us</code>. </p>
<h2>Structure</h2>
<ul>
<li>evaluates the canopy height and leaf area given the presence of snow 
    (or not) using <a href="../proc/hgtabovesnow.html">HgtAboveSnow</a> and <a href="../proc/lai_eff.html">LAI_eff</a></li>
<li>sets the value of soil and snow roughness lengths
    (depends on the configuration of CABLE)</li>
<li>evaluates the remaining output variables, depending on whether the land 
    point is vegetated or not.</li>
<li>if the SLI soil model is used - updates the evaluated <code>rough%rt0us</code></li>
</ul>


    <h3>Arguments</h3>
        <table class="table table-striped varlist">
    <thead>
      <tr>
        <th>Type</th>
<th>Intent</th><th>Optional</th>        <th>Attributes</th>
        <th></th>
        <th>Name</th>
        <th></th>
    </thead>
    <tbody>
        <tr>
            <td>
              <span class="anchor" id="variable-veg~109"></span>
              type(<a href='../type/veg_parameter_type.html'>veg_parameter_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>veg</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-rough~20"></span>
              type(<a href='../type/roughness_type.html'>roughness_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>rough</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-ssnow~73"></span>
              type(<a href='../type/soil_snow_type.html'>soil_snow_type</a>),
            </td>
<td>intent(in)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>ssnow</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-canopy~53"></span>
              type(<a href='../type/canopy_type.html'>canopy_type</a>),
            </td>
<td>intent(inout)</td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>canopy</strong></td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-lai_pft~2"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>LAI_pft</strong>(mp)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-hgt_pft~3"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>HGT_pft</strong>(mp)</td>
            <td>
                
            </td>
        </tr>
        <tr>
            <td>
              <span class="anchor" id="variable-reducedlaidue2snow~12"></span>
              real
            </td>
<td></td>
              <td></td>            <td>
              
            </td>
            <td>::</td>
            <td><strong>reducedLAIdue2snow</strong>(mp)</td>
            <td>
                
            </td>
        </tr>
    </tbody>
  </table>

    <br>

    <section class="visible-xs visible-sm hidden-md">
        <h3>Contents</h3>
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  


    </section>
    <br class="visible-xs visible-sm hidden-md">


    
    

    
    


    
    
    </div>
  </div>

      <hr>
    </div> <!-- /container -->
    <footer>
      <div class="container">
        <div class="row">
          <div class="col-xs-6 col-md-6"><p>CABLE was developed by CABLE community<br>&copy; 2023 
</p>
          </div>
          <div class="col-xs-6 col-md-6">
            <p class="text-right">
              Documentation generated by
              <a href="https://github.com/Fortran-FOSS-Programmers/ford">FORD</a>
            </p>
          </div>
        </div>
        <br>
      </div> <!-- /container -->
    </footer>

    <!-- Bootstrap core JavaScript
         ================================================== -->
         <!-- Placed at the end of the document so the pages load faster -->
    <!--
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        -->
        <script src="../js/bootstrap.min.js"></script>
        <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
        <script src="../js/ie10-viewport-bug-workaround.js"></script>

        <!-- MathJax JavaScript
             ================================================== -->
             <!-- Placed at the end of the document so the pages load faster -->
        <script type="text/x-mathjax-config">
          MathJax.Hub.Config({
          TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
          jax: ['input/TeX','input/MathML','output/HTML-CSS'],
          extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
          });
        </script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>


  </body>
</html>